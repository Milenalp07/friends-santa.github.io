<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Termo do Amigo Secreto</title>

  <!-- CSS externo -->
  <link rel="stylesheet" href="custom.css">
</head>

<body>
  <div class="app">
    <header>
      <h1>TERMO DO AMIGO SECRETO</h1>
      <div>Digite nomes atÃ© acertar</div>
    </header>

    <main>
      <div class="hint">
        Digite um nome e pressione Enter.
        <br>
        ðŸŸ© letra certa no lugar certo Â· ðŸŸ¨ letra existe mas estÃ¡ em outro lugar Â· â¬› nÃ£o existe
      </div>

      <form id="form">
        <input
          id="guess"
          type="text"
          autocomplete="off"
          placeholder="Digite um nome..."
        />
        <button id="btn" type="submit">Tentar</button>
      </form>

      <div class="board" id="board"></div>
      <div class="msg" id="msg"></div>
    </main>
  </div>

  <script>
    /* ======================
       DICAS
    ====================== */
    const HINTS = [
      "Ã‰ uma mulher",
      "O primeiro nome comeÃ§a com L",
      "O nome completo tem 12 letras",
      "O sobrenome comeÃ§a com F"
    ];

    // em quais tentativas a dica aparece
    const HINT_STEPS = [1, 3, 5, 7];

    /* ======================
       FUNÃ‡Ã•ES AUXILIARES
    ====================== */
    function normalize(text) {
      return (text || "")
        .trim()
        .toLowerCase()
        .normalize("NFD")
        .replace(/[\u0300-\u036f]/g, "");
    }

    function padToLen(text, len) {
      if (text.length > len) return text.slice(0, len);
      return text.padEnd(len, " ");
    }

    /* ======================
       CONFIGURAÃ‡ÃƒO
    ====================== */
    const SECRET_RAW = "Linda Fideles"; // ðŸ‘ˆ TROQUE O NOME AQUI
    const SECRET = normalize(SECRET_RAW);
    const MAX_TRIES = 8;

    /* ======================
       ELEMENTOS
    ====================== */
    const form = document.getElementById("form");
    const input = document.getElementById("guess");
    const board = document.getElementById("board");
    const msg = document.getElementById("msg");
    const btn = document.getElementById("btn");

    let tries = 0;
    let solved = false;

    /* ======================
       LÃ“GICA DO JOGO
    ====================== */
    function scoreGuess(guess, secret) {
      const g = padToLen(guess, secret.length);
      const result = Array(secret.length).fill("x");
      const counts = {};

      // Verdes
      for (let i = 0; i < secret.length; i++) {
        if (g[i] === secret[i]) {
          result[i] = "g";
        } else {
          counts[secret[i]] = (counts[secret[i]] || 0) + 1;
        }
      }

      // Amarelos
      for (let i = 0; i < secret.length; i++) {
        if (result[i] === "g") continue;
        const ch = g[i];
        if (ch !== " " && counts[ch] > 0) {
          result[i] = "y";
          counts[ch]--;
        }
      }

      return { letters: g, marks: result };
    }

    function renderRow(rawGuess, scored) {
      const row = document.createElement("div");
      row.className = "row";

      for (let i = 0; i < SECRET.length; i++) {
        const tile = document.createElement("div");
        tile.className = `tile ${scored.marks[i]}`;
        tile.textContent = scored.letters[i].toUpperCase();
        row.appendChild(tile);
      }

      board.prepend(row);
    }

    function endGame(win) {
      solved = true;
      input.disabled = true;
      btn.disabled = true;

      msg.textContent = win
        ? "ðŸŽ‰ Acertou!"
        : `ðŸ˜… Acabaram as tentativas. A resposta era: ${SECRET_RAW.toUpperCase()}`;
    }

    /* ======================
       EVENTO PRINCIPAL
    ====================== */
    form.addEventListener("submit", (e) => {
      e.preventDefault();
      if (solved) return;

      const raw = input.value;
      const guess = normalize(raw);

      msg.textContent = "";

      if (!guess) {
        msg.textContent = "Digite algum nome.";
        return;
      }

      tries++;

      // dica (nÃ£o deixa ser sobrescrita)
      let showedHint = false;
      const hintIndex = HINT_STEPS.indexOf(tries);
      if (hintIndex !== -1 && HINTS[hintIndex]) {
        msg.textContent = `ðŸ’¡ Dica: ${HINTS[hintIndex]}`;
        showedHint = true;
      }

      const scored = scoreGuess(guess, SECRET);
      renderRow(raw.trim(), scored);

      input.value = "";
      input.focus();

      if (guess === SECRET) {
        endGame(true);
        return;
      }

      if (tries >= MAX_TRIES) {
        endGame(false);
        return;
      }

      // sÃ³ mostra tentativas se NÃƒO mostrou dica
      if (!showedHint) {
        msg.textContent = `Tentativas restantes: ${MAX_TRIES - tries}`;
      }
    });
  </script>
</body>
</html>
